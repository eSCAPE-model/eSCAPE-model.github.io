<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Installation" />
<meta property="og:description" content="Getting started For installation information and documentation visit our Github wiki page which provides a quick guide on the installation dependencies.
API documentation is available from the eSCAPE-API website and a set of examples are available in the eSCAPE-demo repository.
The easiest way to get started is with the Docker container https://hub.docker.com/u/geodels/ using Kitematic. Once Kitematic is installed on your computer, open it and look for Geodels escape-docker via the search menu." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://escape-model.github.io/2018/11/installation/" /><meta property="article:published_time" content="2018-11-21T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-11-21T00:00:00&#43;00:00"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Installation"/>
<meta name="twitter:description" content="Getting started For installation information and documentation visit our Github wiki page which provides a quick guide on the installation dependencies.
API documentation is available from the eSCAPE-API website and a set of examples are available in the eSCAPE-demo repository.
The easiest way to get started is with the Docker container https://hub.docker.com/u/geodels/ using Kitematic. Once Kitematic is installed on your computer, open it and look for Geodels escape-docker via the search menu."/>


    <meta name="description" content="">
    <link rel="canonical" href="https://escape-model.github.io/2018/11/installation/">

    
    <title>Installation &middot; eSCAPE</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

    <link href="https://escape-model.github.io/css/style.css" rel="stylesheet">

    

    

    
  </head>
  <body>
    
      



<nav class="white" role="navigation">
    <div class="row max-width">
        <div class="col s12 l10 offset-l1">
            
            <a href="#" data-activates="nav-mobile" class="button-collapse black-text">
                <i class="material-icons">menu</i>
            </a>

            
            <ul id="nav-mobile" class="side-nav">
                
                
    
        
            
<li>
    <a class="black-text" href="/about/">About...</a>
</li>

        
    
        
            
<li>
    <a class="black-text" href="/2018/10/contact/">Contact</a>
</li>

        
    
        
            <ul id="dropdown-header-mobile-2" class="dropdown-content">
                
                    
<li>
    <a class="black-text" href="/2018/11/hands-on-tutorials/">Examples</a>
</li>

                
                    
<li>
    <a class="black-text" href="/2019/04/input-files/">Input files</a>
</li>

                
                    
<li>
    <a class="black-text" href="/2018/11/installation/">Installation</a>
</li>

                
            </ul>
            <li>
                <a class="dropdown-button black-text" href="#!" data-activates="dropdown-header-mobile-2">tutorials
                    <i class="material-icons right">arrow_drop_down</i>
                </a>
            </li>
        
    
    

            </ul>

            
            <a href="/" class="brand-logo grey-text text-darken-3">eSCAPE</a>

            
            <div class="nav-wrapper">

                
                <ul class="right hide-on-med-and-down">
                    
                    
    
        
            
<li>
    <a class="black-text" href="/about/">About...</a>
</li>

        
    
        
            
<li>
    <a class="black-text" href="/2018/10/contact/">Contact</a>
</li>

        
    
        
            <ul id="dropdown-header-desktop-2" class="dropdown-content">
                
                    
<li>
    <a class="black-text" href="/2018/11/hands-on-tutorials/">Examples</a>
</li>

                
                    
<li>
    <a class="black-text" href="/2019/04/input-files/">Input files</a>
</li>

                
                    
<li>
    <a class="black-text" href="/2018/11/installation/">Installation</a>
</li>

                
            </ul>
            <li>
                <a class="dropdown-button black-text" href="#!" data-activates="dropdown-header-desktop-2">tutorials
                    <i class="material-icons right">arrow_drop_down</i>
                </a>
            </li>
        
    
    

                </ul>

            </div>
        </div>
    </div>
</nav>
    

    

<article class="max-width">
    
    <section class="row">
        <div class="col s12 m10 offset-m1 l10 offset-l1">
            <h4>Installation</h4>
        </div>
    </section>

    
    
    <div class="row">
        <div class="col s12 m12 l10 offset-l1">
            <div class="article-image" style="background-image: url('https://escape-model.github.io/images/escapezoom.jpg');"></div>
        </div>
    </div>
    

    
    <section class="row">
        <div class="col s12 m8 offset-m2 l2 offset-l1">
            

<p class="article-meta">
    <div class="article-meta-container">
        <div class="article-meta-author-name"></div>
        <div class="article-meta-description"></div>
    </div>
    <span class="article-meta-published-at grey-text text-darken-1">Nov 21, 2018</span>
</p>
        </div>
        <div class="col s12 m8 offset-m2 l6">
            

<h5 id="getting-started">Getting started</h5>

<p>For installation information and documentation visit our Github <a href="https://github.com/Geodels/eSCAPE/wiki"><strong>wiki page</strong></a> which provides a quick guide on the installation dependencies.</p>

<p>API documentation is available from the <a href="https://escape-api.github.io/index.html"><strong>eSCAPE-API</strong></a> website and a set of examples are available in the <a href="https://github.com/Geodels/eSCAPE-demo"><strong>eSCAPE-demo</strong></a> repository.</p>

<p>The easiest way to get started is with the <strong>Docker container</strong>
<a href="https://hub.docker.com/u/geodels/">https://hub.docker.com/u/geodels/</a> using <a href="https://docs.docker.com/kitematic/userguide/">Kitematic</a>. Once <strong>Kitematic</strong> is installed on your computer, open it and look for <strong>Geodels escape-docker</strong> via the <em>search</em> menu.</p>

<p>If you want to install it yourself, you can follow the steps provided in the <a href="https://github.com/Geodels/eSCAPE/wiki/Installation-on-HPC">wiki</a> page.</p>

<hr />

<h5 id="compilers-packages">Compilers &amp; packages</h5>

<h6 id="list-of-required-compilers">List of required compilers</h6>

<p>Numpy (1.9 and above) and a fortran compiler are required to install <strong>eSCAPE</strong>.</p>

<ul>
<li>The Docker image is based on GNU compiler gfortran 4.5.0</li>
<li>The HPC installation has been tested with both GNU fortran compiler (5.4.0) and Intel-mkl ifort (18.0.1) compiler.</li>
</ul>

<p>If you change the fortran compiler, you may have to define the path prior to running setup.py.</p>

<pre><code class="language-bash">export F90=ifort
cd eSCAPE
python setup.py install --user
</code></pre>

<h6 id="major-minor-versions-of-python">Major.minor versions of Python</h6>

<p><strong>eSCAPE</strong> is compatible with Python version (2.7.x, 3.5.x and above). Python 2.7.11 is used within the provided Docker container and version 2.7.15 has been used for HPC installation.</p>

<h6 id="required-libraries">Required libraries</h6>

<p>Running this code requires the following packages to be installed:</p>

<p><strong>Standard packages:</strong></p>

<ol>
<li><a href="http://www.numpy.org">numpy</a> 1.9 and above</li>
<li><a href="https://www.scipy.org">scipy</a> 0.15 and above</li>
<li><a href="https://mpi4py.readthedocs.io/en/stable/">mpi4py</a> 3.0.0</li>
<li><a href="https://www.mcs.anl.gov/petsc/download/index.html">petsc</a> 3.8.x and above</li>
<li><a href="https://petsc4py.readthedocs.io/en/stable/">petsc4py</a> 3.8.x and above</li>
<li><a href="https://www.h5py.org">h5py</a> with support for HDF5 library version 1.8.4 and above</li>
<li><a href="https://yaml.readthedocs.io/en/latest/">ruamel.yaml</a> 0.15.70</li>
<li><a href="https://pandas.pydata.org">pandas</a> 0.20.3 and above</li>
<li><a href="https://github.com/nschloe/meshio">meshio</a> 2.0.3</li>
</ol>

<p><strong>Custom packages:</strong></p>

<ol>
<li><a href="https://github.com/nschloe/meshplex">meshplex</a> (see installation example below)</li>
<li><a href="https://github.com/Geodels/fillit">fillit</a> (see installation example below)</li>
</ol>

<hr />

<h5 id="installation-examples">Installation examples</h5>

<p>Once the libraries mentioned above have been installed, <strong>eSCAPE</strong> will need to be cloned and compiled using the following:</p>

<pre><code class="language-bash">git clone https://github.com/Geodels/eSCAPE.git
python setup.py install
</code></pre>

<p>An example on how to install it on a <em>HPC server</em> is provided in the <a href="https://github.com/Geodels/eSCAPE/wiki/Installation-on-HPC"><strong>wiki</strong></a> page.</p>

<hr />

<h5 id="testing-escape-installation">Testing eSCAPE installation</h5>

<p>The <a href="https://github.com/Geodels/eSCAPE-demo"><strong>eSCAPE-demo</strong></a> contains a <strong>test</strong> folder that provides manual steps that can be followed to check the expected functionality of the software.</p>

<p>The <strong>test</strong> proposes two comparisons related to:</p>

<ol>
<li>the <em>expected output values</em> that you should be obtained if the installation is successful</li>
<li>runtime for both <em>serial</em> and <em>parallel</em> simulations</li>
</ol>

<p>This test should take less than one minute. An example on how to visualise eSCAPE outputs in <a href="https://www.paraview.org/download/"><strong>Paraview</strong></a> is also provided.</p>

<hr />

<h5 id="docker">Docker</h5>

<p>To use/test <strong>eSCAPE</strong> quickly, it is recommended to use the <code>Geodels escape-docker</code> image that is shipped with all the required libraries.</p>

<p><a href="https://hub.docker.com/u/geodels/">https://hub.docker.com/u/geodels/</a></p>

<hr />

<h5 id="step-by-step-guide">Step-by-step guide</h5>

<p><em>Content</em></p>

<ol>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#installing-petsc-petsc4py-locally">Installing petsc petsc4py locally</a></li>
<li><a href="#installation-on-artemis-hpc-usyd">Installation on Artemis HPC USyD</a></li>
<li><a href="#example-of-pbs-script">Example of PBS script</a></li>
</ol>

<h5 id="dependencies">Dependencies</h5>

<p>When installing <strong>eSCAPE</strong> for the first time the following steps are required:</p>

<pre><code class="language-bash">module purge
module load python/2.7.11
module load gcc/5.4.0
module load openmpi-gcc/1.10.3

pip install numpy --user
pip install scipy --user
pip install pandas --user
pip install h5py --user
pip install mpi4py --user
pip install ruamel.yaml --user
pip install meshio --user
</code></pre>

<p>Then you will install <code>meshplex</code> library:</p>

<pre><code class="language-bash">git clone https://github.com/Geodels/meshplex.git
cd meshplex
python setup.py install --user
cd ..
</code></pre>

<p>Now <code>petsc4py</code>: in case everything works nicely you should be able to do:</p>

<pre><code class="language-bash">module load petsc-gcc-openmpi/3.8.4
export PETSC_DIR=/usr/local/petsc-gcc-openmpi/3.8.4/
pip install petsc4py --user
</code></pre>

<p>(see next section if you need to build <code>petsc</code> locally&hellip;)</p>

<p>Last required package for running <strong>eSCAPE</strong> is <code>FILLIT</code>:</p>

<pre><code class="language-bash">export F90=gfortran
git clone https://github.com/Geodels/fillit.git
cd fillit
python setup.py install --user
</code></pre>

<p>OK, now that all dependencies are installed we can proceed with <strong>eSCAPE</strong>:</p>

<pre><code class="language-bash">git clone https://github.com/Geodels/eSCAPE.git
cd eSCAPE
python setup.py install --user
</code></pre>

<h5 id="installing-petsc-petsc4py-locally">Installing petsc petsc4py locally</h5>

<pre><code class="language-bash">
module load cmake
git clone https://bitbucket.org/petsc/petsc.git
cd petsc
export PETSC_VERSION=3.9.3
git checkout tags/v$PETSC_VERSION

cd /home/path
export PETSC_DIR=/home/path/petsc

./configure --CFLAGS='-O3' --CXXFLAGS='-O3' --FFLAGS='-O3' --CPPFLAGS=$CPPFLAGS --LDFLAGS=$LDFLAGS  --MPI-DIR=$MPI_DIR  --with-debugging=no  --download-fblaslapack --download-ctetgen --download-metis=yes --download-parmetis=yes --download-triangle

make PETSC_DIR=/home/path/petsc PETSC_ARCH=arch-linux2-c-opt all

pip install petsc4py --user
</code></pre>

<h5 id="installation-on-artemis-hpc-usyd">Installation on Artemis HPC USyD</h5>

<pre><code class="language-bash">module purge
module load python/2.7.15-intel petsc-intel-mpi hdf5
export F90=ifort
git clone https://github.com/Geodels/fillit.git
cd fillit
python setup.py install --user

git clone https://github.com/Geodels/eSCAPE.git
cd eSCAPE
python setup.py install --user
</code></pre>

<h5 id="example-of-pbs-script">Example of PBS script</h5>

<p>Here is an example of PBS job for <code>Artemis</code> HPC (USyD):</p>

<pre><code class="language-bash">#!/bin/bash

# Project
#PBS -P BGH

# 64 CPUs
#PBS -l select=8:ncpus=8:mpiprocs=8:mem=8GB

# Time limit
#PBS -l walltime=10:00:00
#PBS -q alloc-dm

# Set up environment
module load python/2.7.15-intel petsc-intel-mpi hdf5

cd $PBS_O_WORKDIR
cd earth

# Launching the job!
mpirun -np 64 python run_espace.py
</code></pre>

<p>with <code>run_espace.py</code> a python script calling <strong>eSCAPE</strong> function:</p>

<pre><code class="language-python">import eSCAPE as sim

# Reading input file
model = sim.LandscapeEvolutionModel('input_globe.yml',False,False)

# Running model
model.runProcesses()

# Cleaning model
model.destroy()
</code></pre>

<p>Use <code>qsub</code> command to launch.</p>

        </div>
    </section>
</article>




    
      <footer class="page-footer grey lighten-5">
    <div class="row max-width">
        <div class="col s12 l10 offset-l1 clear-padding">
            <div class="row">
    
        
    

    
    
    <div class="col s12 l12">
        <h5 class="black-text">eSCAPE</h5>
<p class="grey-text text-darken-4">modelling surface dynamics like never before ...</p>

    </div>

    
</div>


        </div>
    </div>
    <div class="footer-copyright">
        <div class="row max-width" style="width: 100%;">
            <div class="col s12 l10 offset-l1">
                <span class="grey-text text-darken-4">Tristan Salles - School of Geosciences - The University of Sydney</span>
<div class="right">
    
</div>
            </div>
        </div>
    </div>
</footer>

    

    
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <script src="https://escape-model.github.io/js/script.js"></script>
  </body>
</html>